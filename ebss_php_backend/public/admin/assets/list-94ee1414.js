import{_ as v,T as f,a as l,o as u,f as p,w as s,d as r,i as b}from"./index-933077c7.js";const h={name:"list",data:function(){return{TreeSelect:f,table:"role",showDelete:e=>e[this.table_key]!==1,saveFormData:{permission_ids:[]},searchObj:{},treeData:[],columns:[{title:"角色名称",key:"role_name"}]}},computed:{table_key(){return`${this.table}_id`}},components:{},async created(){await this.getPermissions()},methods:{saveFunc(e){this.post("/admin/crud/save",{table:this.table,...e,permission_ids:JSON.stringify(e.permission_ids.map(a=>a.value))}).then(({code:a})=>{a===1&&this.success("保存成功！")})},async getPermissions(){const{paginate:e,code:a}=await this.get("/admin/crud/list",{table:"permission"});if(a===1){let i=e.data.filter(t=>t.is_show);this.treeData=i.map(t=>({id:t.permission_id,pId:t.pid,value:t.permission_id,label:t.name}))}}}};function D(e,a,i,t,y,F){const m=l("a-input"),n=l("a-form-item"),_=l("a-tree-select"),d=l("a-form"),c=l("Crud");return u(),p(c,null,{save:s(()=>[r(d,{ref:"save_form",model:e.saveFormData,"label-col":{span:6},"wrapper-col":{span:18}},{default:s(()=>[r(n,{label:"角色名称",name:"role_name",rules:[{required:!0,message:""}]},{default:s(()=>[r(m,{disabled:e.saveFormData.role_name&&e.saveFormData.role_name==="超级管理员",value:e.saveFormData.role_name,"onUpdate:value":a[0]||(a[0]=o=>e.saveFormData.role_name=o)},null,8,["disabled","value"])]),_:1}),e.saveFormData.role_name!=="超级管理员"?(u(),p(n,{key:0,label:"权限",name:"permission_ids",rules:[{required:!0,message:""}]},{default:s(()=>[r(_,{value:e.saveFormData.permission_ids,"onUpdate:value":a[1]||(a[1]=o=>e.saveFormData.permission_ids=o),style:{width:"100%"},"tree-data":e.treeData,treeDataSimpleMode:!0,treeCheckStrictly:!0,"tree-checkable":"","allow-clear":"",placeholder:"请选择",treeDefaultExpandAll:!0},null,8,["value","tree-data"])]),_:1})):b("",!0)]),_:1},8,["model"])]),search:s(()=>[r(d,{layout:"inline"},{default:s(()=>[r(n,null,{default:s(()=>[r(m,{placeholder:"角色名称",value:e.searchObj.role_name,"onUpdate:value":a[2]||(a[2]=o=>e.searchObj.role_name=o)},null,8,["value"])]),_:1})]),_:1})]),_:1})}const k=v(h,[["render",D]]);export{k as default};
