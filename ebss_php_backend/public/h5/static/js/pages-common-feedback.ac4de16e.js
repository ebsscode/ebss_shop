(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-common-feedback"],{1299:function(t,e,n){"use strict";(function(t){n("7a82");var a=n("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=a(n("c7eb")),r=a(n("1da1"));n("a9e3"),n("d81d"),n("14d9"),n("a434"),n("e9c4"),n("d3b7");var s={data:function(){return{baseURL:this.baseURL,imageList:[]}},props:{value:{type:[String]},chooseCount:{type:Number,value:5},max:{type:Number,value:100}},watch:{value:{handler:function(e,n){if(e){if(1==this.max&&(this.imageList=[{url:e}]),this.max>1)try{this.imageList=JSON.parse(e).map((function(t){return{url:t}}))}catch(a){this.imageList=[],t.warn("ImgUpload解析错出：",a)}}else this.imageList=[];this.emitValue()},immediate:!0}},computed:{rduLength:function(){return this.max-this.imageList.length}},methods:{chooseImage:function(){var t=this;uni.chooseImage({count:this.rduLength<this.chooseCount?this.rduLength:this.chooseCount,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(e){var n=e.tempFilePaths;t.uploadFiles(n)}})},uploadFiles:function(e){var n=this;return(0,r.default)((0,i.default)().mark((function a(){var r,s;return(0,i.default)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n.imageList.push({progress:0}),uni.showLoading({title:"请稍后..",mask:!0}),r=null,a.prev=3,a.next=6,n.uploadImage(e[0]);case 6:r=a.sent,t.log(11,r),a.next=14;break;case 10:return a.prev=10,a.t0=a["catch"](3),t.log(a.t0),a.abrupt("return");case 14:!1!==r?(e.splice(0,1),s=JSON.parse(JSON.stringify(n.imageList)),s[s.length-1].url=r,n.imageList=s,e.length>0&&n.rduLength>0?n.uploadFiles(e):uni.hideLoading(),n.emitValue()):(n.imageList.pop(),uni.hideLoading(),uni.showToast({title:"上传中出现问题，已终止上传",icon:"none",mask:!0,duration:2e3}));case 15:case"end":return a.stop()}}),a,null,[[3,10]])})))()},uploadImage:function(e){var n=this;return new Promise((function(a,i){n.uploadTask=uni.uploadFile({url:n.baseURL+"/index/index/upload",filePath:e,name:"file",formData:{},success:function(e){var n=JSON.parse(e.data)||{};t.log("111",n),1==n.code&&n.savename?a(n.savename):i("接口返回错误")},fail:function(){i("网络链接错误")}}),n.uploadTask.onProgressUpdate((function(t){n.imageList[n.imageList.length-1].progress=t.progress}))}))},delImage:function(t){var e=this;uni.showModal({content:"确定要丢弃这张图片么？",success:function(n){n.confirm&&(e.imageList.splice(t,1),e.emitValue())}})},emitValue:function(){1==this.max&&(this.imageList.length?this.$emit("input",this.imageList[0].url):this.$emit("input","")),this.max>1&&(this.imageList.length?this.$emit("input",JSON.stringify(this.imageList.map((function(t){return t.url})))):this.$emit("input","[]"))},previewImage:function(t){var e=this,n=this.imageList.map((function(t){return e.baseURL+"/"+t.url}));uni.previewImage({current:n[t],urls:n,indicator:"number"})}}};e.default=s}).call(this,n("5a52")["default"])},"47a6":function(t,e,n){var a=n("24fb");e=a(!1),e.push([t.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 通用 */\r\n/* 文字尺寸 */\r\n/* 页面配置 */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */.upload-content[data-v-6287558c]{display:flex;align-items:center;margin-bottom:10px;margin-right:10px;flex-wrap:wrap}.upload-item[data-v-6287558c]{position:relative;float:left;width:%?150?%;height:%?150?%;margin-right:8px;margin-bottom:8px}.upload-item .upload-img[data-v-6287558c]{width:100%;height:100%;border-radius:%?8?%}.upload-item .upload-del-btn[data-v-6287558c]{position:absolute;right:-8px;top:-11px;width:%?36?%;height:%?36?%;border:%?4?% solid #fff;border-radius:100px}.upload-item .upload-progress[data-v-6287558c]{position:absolute;left:0;top:0;display:flex;align-items:center;justify-content:center;width:100%;height:100%;background-color:rgba(0,0,0,.4);color:#fff;font-size:%?24?%;border-radius:%?8?%}.upload-add-btn[data-v-6287558c]{position:relative;float:left;width:%?150?%;height:%?150?%;z-index:99;border-radius:%?8?%;background:#f9f9f9}.upload-add-btn[data-v-6287558c]:before, .upload-add-btn[data-v-6287558c]:after{content:" ";position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);width:%?4?%;height:%?60?%;background-color:#d6d6d6}.upload-add-btn[data-v-6287558c]:after{width:%?60?%;height:%?4?%}.upload-add-btn[data-v-6287558c]:active{background-color:#f7f7f7}',""]),t.exports=e},"6f7c":function(t,e,n){"use strict";(function(t){n("7a82");var a=n("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=a(n("5530")),r=a(n("7569")),s={components:{ImgUpload:r.default},data:function(){return{mch_id:null,rules:{content:{rules:[{required:!0,errorMessage:"反馈内容不能为空"}]}},form:{imgs:"[]"}}},onLoad:function(t){this.mch_id=t.mch_id},methods:{submit:function(e){var n=this;t.log("form",this.form),this.$refs.form.validate().then((function(e){t.log("表单数据信息：",e),n.post("crud/save",(0,i.default)((0,i.default)({table:"feedback"},n.form),{},{user_id:uni.getStorageSync("user_id")})).then((function(t){var e=t.code;1===e&&(n.success("提交成功！"),n.back("",1200))}))})).catch((function(e){t.log("表单错误信息：",e),n.error(e[0].errorMessage)}))}}};e.default=s}).call(this,n("5a52")["default"])},7569:function(t,e,n){"use strict";n.r(e);var a=n("779a"),i=n("fdbb");for(var r in i)["default"].indexOf(r)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(r);n("cda1");var s=n("f0c5"),o=Object(s["a"])(i["default"],a["b"],a["c"],!1,null,"6287558c",null,!1,a["a"],void 0);e["default"]=o.exports},"779a":function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){}));var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"upload-content"},[t._l(t.imageList,(function(e,a){return[n("v-uni-view",{key:a+"_0",staticClass:"upload-item"},[e.url?n("v-uni-image",{staticClass:"upload-img",attrs:{src:t.baseURL+"/"+e.url,mode:"aspectFill"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.previewImage(a)}}}):n("v-uni-view",{staticClass:"upload-img",staticStyle:{"background-color":"#C0C4CC"}}),n("v-uni-text",{staticClass:"myicon icon-round_delete upload-del-btn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.delImage(a)}}}),e.progress&&e.progress<100?n("v-uni-view",{staticClass:"upload-progress"},[t._v(t._s(e.progress)+"%")]):t._e()],1)]})),t.rduLength>0?n("v-uni-view",{staticClass:"upload-add-btn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.chooseImage.apply(void 0,arguments)}}}):t._e()],2)},i=[]},"9a6c":function(t,e,n){var a=n("24fb");e=a(!1),e.push([t.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 通用 */\r\n/* 文字尺寸 */\r\n/* 页面配置 */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */.form-item[data-v-af63c7f2]{display:flex;align-items:center}',""]),t.exports=e},b784:function(t,e,n){"use strict";var a=n("f106"),i=n.n(a);i.a},c1db:function(t,e,n){"use strict";n.r(e);var a=n("edc0"),i=n("fd06");for(var r in i)["default"].indexOf(r)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(r);n("b784");var s=n("f0c5"),o=Object(s["a"])(i["default"],a["b"],a["c"],!1,null,"af63c7f2",null,!1,a["a"],void 0);e["default"]=o.exports},cda1:function(t,e,n){"use strict";var a=n("d087"),i=n.n(a);i.a},d087:function(t,e,n){var a=n("47a6");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var i=n("4f06").default;i("c52b2776",a,!0,{sourceMap:!1,shadowMode:!1})},edc0:function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return r})),n.d(e,"a",(function(){return a}));var a={uniForms:n("d126").default,uniFormsItem:n("b018").default,uniEasyinput:n("b54b").default},i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticStyle:{padding:"30px 10px 0 10px"}},[n("StatusBar"),n("uni-forms",{ref:"form",attrs:{model:t.form,rules:t.rules}},[n("uni-forms-item",{attrs:{label:"反馈内容",name:"content",required:!0,"label-width":"90px"}},[n("uni-easyinput",{attrs:{type:"textarea",placeholder:"请输入"},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1),n("uni-forms-item",{attrs:{label:"相片",name:"imgs","label-width":"90px"}},[n("ImgUpload",{attrs:{max:5},model:{value:t.form.imgs,callback:function(e){t.$set(t.form,"imgs",e)},expression:"form.imgs"}})],1),n("v-uni-view",{staticClass:"btn-primary",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.submit.apply(void 0,arguments)}}},[t._v("提交")])],1)],1)},r=[]},f106:function(t,e,n){var a=n("9a6c");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var i=n("4f06").default;i("7383c726",a,!0,{sourceMap:!1,shadowMode:!1})},fd06:function(t,e,n){"use strict";n.r(e);var a=n("6f7c"),i=n.n(a);for(var r in a)["default"].indexOf(r)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(r);e["default"]=i.a},fdbb:function(t,e,n){"use strict";n.r(e);var a=n("1299"),i=n.n(a);for(var r in a)["default"].indexOf(r)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(r);e["default"]=i.a}}]);