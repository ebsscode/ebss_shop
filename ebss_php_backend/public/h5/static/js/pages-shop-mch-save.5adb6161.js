(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-shop-mch-save"],{1299:function(e,t,a){"use strict";(function(e){a("7a82");var r=a("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(a("c7eb")),n=r(a("1da1"));a("a9e3"),a("d81d"),a("14d9"),a("a434"),a("e9c4"),a("d3b7");var s={data:function(){return{baseURL:this.baseURL,imageList:[]}},props:{value:{type:[String]},chooseCount:{type:Number,value:5},max:{type:Number,value:100}},watch:{value:{handler:function(t,a){if(t){if(1==this.max&&(this.imageList=[{url:t}]),this.max>1)try{this.imageList=JSON.parse(t).map((function(e){return{url:e}}))}catch(r){this.imageList=[],e.warn("ImgUpload解析错出：",r)}}else this.imageList=[];this.emitValue()},immediate:!0}},computed:{rduLength:function(){return this.max-this.imageList.length}},methods:{chooseImage:function(){var e=this;uni.chooseImage({count:this.rduLength<this.chooseCount?this.rduLength:this.chooseCount,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(t){var a=t.tempFilePaths;e.uploadFiles(a)}})},uploadFiles:function(t){var a=this;return(0,n.default)((0,i.default)().mark((function r(){var n,s;return(0,i.default)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a.imageList.push({progress:0}),uni.showLoading({title:"请稍后..",mask:!0}),n=null,r.prev=3,r.next=6,a.uploadImage(t[0]);case 6:n=r.sent,e.log(11,n),r.next=14;break;case 10:return r.prev=10,r.t0=r["catch"](3),e.log(r.t0),r.abrupt("return");case 14:!1!==n?(t.splice(0,1),s=JSON.parse(JSON.stringify(a.imageList)),s[s.length-1].url=n,a.imageList=s,t.length>0&&a.rduLength>0?a.uploadFiles(t):uni.hideLoading(),a.emitValue()):(a.imageList.pop(),uni.hideLoading(),uni.showToast({title:"上传中出现问题，已终止上传",icon:"none",mask:!0,duration:2e3}));case 15:case"end":return r.stop()}}),r,null,[[3,10]])})))()},uploadImage:function(t){var a=this;return new Promise((function(r,i){a.uploadTask=uni.uploadFile({url:a.baseURL+"/index/index/upload",filePath:t,name:"file",formData:{},success:function(t){var a=JSON.parse(t.data)||{};e.log("111",a),1==a.code&&a.savename?r(a.savename):i("接口返回错误")},fail:function(){i("网络链接错误")}}),a.uploadTask.onProgressUpdate((function(e){a.imageList[a.imageList.length-1].progress=e.progress}))}))},delImage:function(e){var t=this;uni.showModal({content:"确定要丢弃这张图片么？",success:function(a){a.confirm&&(t.imageList.splice(e,1),t.emitValue())}})},emitValue:function(){1==this.max&&(this.imageList.length?this.$emit("input",this.imageList[0].url):this.$emit("input","")),this.max>1&&(this.imageList.length?this.$emit("input",JSON.stringify(this.imageList.map((function(e){return e.url})))):this.$emit("input","[]"))},previewImage:function(e){var t=this,a=this.imageList.map((function(e){return t.baseURL+"/"+e.url}));uni.previewImage({current:a[e],urls:a,indicator:"number"})}}};t.default=s}).call(this,a("5a52")["default"])},"1cec":function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){return r}));var r={uniForms:a("d126").default,uniFormsItem:a("b018").default,uniEasyinput:a("b54b").default},i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",{staticStyle:{padding:"20rpx 10px"}},[a("StatusBar"),a("uni-forms",{ref:"form",attrs:{model:e.form,rules:e.rules}},[a("uni-forms-item",{attrs:{label:"店铺名称",name:"name",required:!0,"label-width":"90px"}},[a("uni-easyinput",{attrs:{placeholder:"请输入"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("uni-forms-item",{attrs:{label:"详细地址",name:"address",required:!0,"label-width":"90px"}},[a("v-uni-view",{staticClass:"align-center justify-between"},[a("uni-easyinput",{attrs:{disabled:!e.form.latitude,placeholder:"请选择"},model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}}),a("v-uni-text",{staticClass:"myicon icon-shouhuodizhi",staticStyle:{"font-size":"20px",padding:"6px 8px"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.chooseMap.apply(void 0,arguments)}}})],1)],1),a("uni-forms-item",{attrs:{label:"简介",name:"title","label-width":"90px"}},[a("uni-easyinput",{attrs:{type:"textarea",placeholder:"请输入简介"},model:{value:e.form.title,callback:function(t){e.$set(e.form,"title",t)},expression:"form.title"}})],1),a("uni-forms-item",{attrs:{label:"门头照片",name:"logo_img","label-width":"90px"}},[a("ImgUpload",{attrs:{max:1},model:{value:e.form.logo_img,callback:function(t){e.$set(e.form,"logo_img",t)},expression:"form.logo_img"}})],1),a("uni-forms-item",{attrs:{label:"联系方式",name:"submitter_tel","label-width":"90px"}},[a("uni-easyinput",{attrs:{placeholder:"请输入"},model:{value:e.form.submitter_tel,callback:function(t){e.$set(e.form,"submitter_tel",t)},expression:"form.submitter_tel"}})],1),a("v-uni-view",{staticClass:"btn-primary",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.submit.apply(void 0,arguments)}}},[e._v("提交")])],1)],1)},n=[]},"47a6":function(e,t,a){var r=a("24fb");t=r(!1),t.push([e.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 通用 */\r\n/* 文字尺寸 */\r\n/* 页面配置 */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */.upload-content[data-v-6287558c]{display:flex;align-items:center;margin-bottom:10px;margin-right:10px;flex-wrap:wrap}.upload-item[data-v-6287558c]{position:relative;float:left;width:%?150?%;height:%?150?%;margin-right:8px;margin-bottom:8px}.upload-item .upload-img[data-v-6287558c]{width:100%;height:100%;border-radius:%?8?%}.upload-item .upload-del-btn[data-v-6287558c]{position:absolute;right:-8px;top:-11px;width:%?36?%;height:%?36?%;border:%?4?% solid #fff;border-radius:100px}.upload-item .upload-progress[data-v-6287558c]{position:absolute;left:0;top:0;display:flex;align-items:center;justify-content:center;width:100%;height:100%;background-color:rgba(0,0,0,.4);color:#fff;font-size:%?24?%;border-radius:%?8?%}.upload-add-btn[data-v-6287558c]{position:relative;float:left;width:%?150?%;height:%?150?%;z-index:99;border-radius:%?8?%;background:#f9f9f9}.upload-add-btn[data-v-6287558c]:before, .upload-add-btn[data-v-6287558c]:after{content:" ";position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);width:%?4?%;height:%?60?%;background-color:#d6d6d6}.upload-add-btn[data-v-6287558c]:after{width:%?60?%;height:%?4?%}.upload-add-btn[data-v-6287558c]:active{background-color:#f7f7f7}',""]),e.exports=t},"4d1b":function(e,t,a){var r=a("24fb");t=r(!1),t.push([e.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 通用 */\r\n/* 文字尺寸 */\r\n/* 页面配置 */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */.form-item[data-v-14b98ce2]{display:flex;align-items:center}',""]),e.exports=t},"6ee7":function(e,t,a){"use strict";a.r(t);var r=a("ca7c"),i=a.n(r);for(var n in r)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return r[e]}))}(n);t["default"]=i.a},7569:function(e,t,a){"use strict";a.r(t);var r=a("779a"),i=a("fdbb");for(var n in i)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(n);a("cda1");var s=a("f0c5"),o=Object(s["a"])(i["default"],r["b"],r["c"],!1,null,"6287558c",null,!1,r["a"],void 0);t["default"]=o.exports},"779a":function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){}));var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",{staticClass:"upload-content"},[e._l(e.imageList,(function(t,r){return[a("v-uni-view",{key:r+"_0",staticClass:"upload-item"},[t.url?a("v-uni-image",{staticClass:"upload-img",attrs:{src:e.baseURL+"/"+t.url,mode:"aspectFill"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.previewImage(r)}}}):a("v-uni-view",{staticClass:"upload-img",staticStyle:{"background-color":"#C0C4CC"}}),a("v-uni-text",{staticClass:"myicon icon-round_delete upload-del-btn",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.delImage(r)}}}),t.progress&&t.progress<100?a("v-uni-view",{staticClass:"upload-progress"},[e._v(e._s(t.progress)+"%")]):e._e()],1)]})),e.rduLength>0?a("v-uni-view",{staticClass:"upload-add-btn",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.chooseImage.apply(void 0,arguments)}}}):e._e()],2)},i=[]},a168:function(e,t,a){var r=a("4d1b");r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var i=a("4f06").default;i("077347ca",r,!0,{sourceMap:!1,shadowMode:!1})},af22:function(e,t,a){"use strict";var r=a("a168"),i=a.n(r);i.a},b6cf:function(e,t,a){"use strict";a.r(t);var r=a("1cec"),i=a("6ee7");for(var n in i)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(n);a("af22");var s=a("f0c5"),o=Object(s["a"])(i["default"],r["b"],r["c"],!1,null,"14b98ce2",null,!1,r["a"],void 0);t["default"]=o.exports},ca7c:function(e,t,a){"use strict";(function(e){a("7a82");var r=a("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(a("c7eb")),n=r(a("1da1")),s=r(a("5530")),o=r(a("7569")),u={components:{ImgUpload:o.default},data:function(){return{type:"",rules:{name:{rules:[{required:!0,errorMessage:"名称不能为空"}]},address:{rules:[{required:!0,errorMessage:"地址不能为空"}]}},form:{services:[],address:""}}},onLoad:function(e){e.type&&(this.type=e.type,"join"==e.type&&(uni.setNavigationBarTitle({title:"服务点加盟"}),this.rules.title={rules:[{required:!0,errorMessage:"简介不能为空"}]},this.rules.open_time={rules:[{required:!0,errorMessage:"开放时间不能为空"}]},this.rules.log_img={rules:[{required:!0,errorMessage:"门头照片不能为空"}]},this.rules.device_img={rules:[{required:!0,errorMessage:"设置照片不能为空"}]},this.rules.owner_tel={rules:[{required:!0,errorMessage:"联系方式不能为空"}]}))},methods:{submit:function(t){var a=this;e.log("form",this.form),this.$refs.form.validate().then((function(t){e.log("表单数据信息：",t),a.post("crud/save",(0,s.default)({table:"mch"},a.form)).then((function(e){var t=e.code;1===t&&(a.success("标注成功！"),a.redirect("/pages/water/mch/mchlist",1200))}))})).catch((function(t){e.log("表单错误信息：",t),a.error(t[0].errorMessage)}))},chooseMap:function(){var e=this;return(0,n.default)((0,i.default)().mark((function t(){var a;return(0,i.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.util.chooseLocation();case 2:a=t.sent,1==a.code&&(e.form.longitude=a.longitude,e.form.latitude=a.latitude,e.form.province=a.province,e.form.city=a.city,e.form.district=a.district,e.form.address=a.address);case 4:case"end":return t.stop()}}),t)})))()}}};t.default=u}).call(this,a("5a52")["default"])},cda1:function(e,t,a){"use strict";var r=a("d087"),i=a.n(r);i.a},d087:function(e,t,a){var r=a("47a6");r.__esModule&&(r=r.default),"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var i=a("4f06").default;i("c52b2776",r,!0,{sourceMap:!1,shadowMode:!1})},fdbb:function(e,t,a){"use strict";a.r(t);var r=a("1299"),i=a.n(r);for(var n in r)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return r[e]}))}(n);t["default"]=i.a}}]);