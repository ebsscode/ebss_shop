(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-shop-order-createorder"],{"1ede":function(t,e,i){"use strict";var a=i("fec9"),s=i.n(a);s.a},"7a25":function(t,e,i){"use strict";(function(t){i("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("d81d"),i("13d5"),i("d3b7"),i("4de4");var a={data:function(){return{user_coupon_list:[],goods_spec:[],goods_list:[],baseURL:this.baseURL,price_total:0,freight:0,discount:10,maskState:0,notes:"",addr:null,checkCoupon:null,addr_line_img:this.constant.addr_line_img}},onLoad:function(e){var i=this;e.goods_spec&&(this.goods_spec=e.goods_spec.split("|").map((function(t){return t.split("-")})),t.log(222,this.goods_spec),this.getData()),this.post("shop/page_createorder",{goods_ids:this.goods_spec.map((function(t){return t[0]}))}).then((function(t){var e=t.code,a=t.addr;1===e&&(i.addr=a)})),this.get("coupon/my",{status:4}).then((function(t){var e=t.code,a=t.list;1==e&&(i.user_coupon_list=a.map((function(t){i.util.getTime10();return t.checked=!1,t})))}))},methods:{couponCheck:function(t,e){var i=this.util.getTime10();if(i>e.coupon.expire_time)this.error("优惠券已过期！");else if(e.coupon.full_amount>0&&this.price_total<e.coupon.full_amount)this.error("订单金额满".concat(e.coupon.full_amount,"可使用！"));else{if(1==e.coupon.is_superimposed)return this.user_coupon_list[t].checked=!this.user_coupon_list[t].checked,void this.getPriceTotal();var a=this.user_coupon_list.map((function(e,i){return 0==e.coupon.is_superimposed&&i!=t&&(e.checked=!1),e}));a[t].checked=!a[t].checked,this.user_coupon_list=a,this.getPriceTotal()}},changeAddr:function(t){this.addr=t},getData:function(){var t=this;this.post("crud/list",{table:"goods",table_ids:this.goods_spec.map((function(t){return t[0]})),join_tables:["mch"]}).then((function(e){var i=e.code,a=e.paginate;1===i&&(t.goods_list=a.data.map((function(e,i){return e.amount=t.goods_spec[i][1],e.selected_spec=t.goods_spec[i][2],e})),t.getPriceTotal(),t.freight=t.goods_list.reduce((function(t,e){return 1*t+1*e.freight}),0))}))},getPriceTotal:function(){var e=this.goods_list.reduce((function(t,e){return 1*t+e.price*e.amount}),0);this.price_total=e;var i=this.user_coupon_list.reduce((function(t,e){return e.checked&&1==e.coupon.type?1*t+1*e.coupon.amount:t}),0),a=this.user_coupon_list.reduce((function(t,i){if(i.checked&&2==i.coupon.type){var a=(10-i.coupon.amount)/10*e;return e-=a,1*t+a}return t}),0);t.log(111,a),this.discount=i+a},toggleMask:function(t){var e=this,i="show"===t?10:300,a="show"===t?1:0;this.maskState=2,setTimeout((function(){e.maskState=a}),i)},submit:function(){var t=this;if(this.addr){var e=this.user_coupon_list.filter((function(t){return t.checked}));this.post("order/create",{addr:this.addr,goods_list:this.goods_list,price_total:this.price_total,notes:this.notes,discount:this.discount,freight:this.freight,coupon_list:e}).then((function(e){var i=e.code,a=e.msg,s=(e.order_id,e.paylog_id);1===i&&(t.success(a),t.redirect("/pages/shop/cashier/pay?paylog_id="+s))}))}else this.error("请选择收货地址")},stopPrevent:function(){}}};e.default=a}).call(this,i("5a52")["default"])},b3d7:function(t,e,i){"use strict";i.d(e,"b",(function(){return a})),i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){}));var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",[i("StatusBar"),i("v-uni-view",{staticClass:"address-section",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.nav("/pages/shop/addr/addrlist?from=choose")}}},[i("v-uni-view",{staticClass:"addr-content justify-between"},[i("v-uni-text",{staticClass:"myicon icon-shouhuodizhi"}),t.addr?i("v-uni-view",{staticClass:"cen"},[i("v-uni-view",{staticClass:"top"},[i("v-uni-text",{staticClass:"name"},[t._v(t._s(t.addr.name))]),i("v-uni-text",{staticClass:"mobile"},[t._v(t._s(t.addr.tel))])],1),i("v-uni-text",{staticClass:"address"},[t._v(t._s(t.addr.district)+" "+t._s(t.addr.address))])],1):i("v-uni-view",[t._v("创建收货地址")]),i("v-uni-text",{staticClass:"myicon icon-xiangyou1"})],1),i("v-uni-image",{staticClass:"a-bg",attrs:{src:t.addr_line_img}})],1),i("v-uni-view",{staticClass:"goods-section"},[i("v-uni-view",{staticClass:"g-header b-b"},[i("v-uni-image",{staticStyle:{width:"25px",height:"25px","border-radius":"100px"},attrs:{src:"/static/logo.jpg"}}),i("v-uni-text",{staticClass:"name"},[t._v("西城小店铺")])],1),t._l(t.goods_list,(function(e,a){return i("v-uni-view",{key:a,staticClass:"g-item"},[i("v-uni-image",{attrs:{src:t.baseURL+"/"+e.cover_img}}),i("v-uni-view",{staticClass:"right"},[i("v-uni-text",{staticClass:"title clamp"},[t._v(t._s(e.title))]),i("v-uni-text",{staticClass:"spec"},[t._v(t._s(t.goods_spec[a][2]))]),i("v-uni-view",{staticClass:"price-box"},[i("v-uni-text",{staticClass:"price"},[t._v("￥"+t._s(e.price))]),i("v-uni-text",{staticClass:"number"},[t._v("x "+t._s(t.goods_spec[a][1]))])],1)],1)],1)}))],2),i("v-uni-view",{staticClass:"yt-list"},[t.user_coupon_list.length?i("v-uni-view",{staticClass:"yt-list-cell b-b",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toggleMask("show")}}},[i("v-uni-view",{staticClass:"cell-icon"},[t._v("券")]),i("v-uni-text",{staticClass:"cell-tit clamp"},[t._v("优惠券")]),i("v-uni-text",{staticClass:"cell-tip active"},[t._v("选择优惠券")]),i("v-uni-text",{staticClass:"cell-more wanjia wanjia-gengduo-d"})],1):t._e(),i("v-uni-view",{staticClass:"yt-list-cell b-b",staticStyle:{display:"none"}},[i("v-uni-view",{staticClass:"cell-icon hb"},[t._v("减")]),i("v-uni-text",{staticClass:"cell-tit clamp"},[t._v("商家促销")]),i("v-uni-text",{staticClass:"cell-tip disabled"},[t._v("暂无可用优惠")])],1)],1),i("v-uni-view",{staticClass:"yt-list"},[i("v-uni-view",{staticClass:"yt-list-cell b-b"},[i("v-uni-text",{staticClass:"cell-tit clamp"},[t._v("商品金额")]),i("v-uni-text",{staticClass:"cell-tip"},[t._v("￥"+t._s(t.price_total.toFxied(2)))])],1),i("v-uni-view",{staticClass:"yt-list-cell b-b"},[i("v-uni-text",{staticClass:"cell-tit clamp"},[t._v("优惠金额")]),i("v-uni-text",{staticClass:"cell-tip red"},[t._v("-￥"+t._s(t.discount.toFxied(2)))])],1),i("v-uni-view",{staticClass:"yt-list-cell b-b"},[i("v-uni-text",{staticClass:"cell-tit clamp"},[t._v("运费")]),i("v-uni-text",{staticClass:"cell-tip"},[t._v("￥"+t._s(t.freight?t.freight:"免运费"))])],1),i("v-uni-view",{staticClass:"yt-list-cell desc-cell"},[i("v-uni-text",{staticClass:"cell-tit clamp"},[t._v("备注")]),i("v-uni-input",{staticClass:"desc",attrs:{type:"text",placeholder:"请填写备注信息","placeholder-class":"placeholder"},model:{value:t.notes,callback:function(e){t.notes=e},expression:"notes"}})],1)],1),i("v-uni-view",{staticClass:"footer"},[i("v-uni-view",{staticClass:"price-content"},[i("v-uni-text",[t._v("实付款")]),i("v-uni-text",{staticClass:"price-tip"},[t._v("￥")]),i("v-uni-text",{staticClass:"price"},[t._v(t._s((t.price_total+t.freight-t.discount).toFxied(2)))])],1),i("v-uni-text",{staticClass:"submit",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.submit.apply(void 0,arguments)}}},[t._v("提交订单")])],1),i("v-uni-view",{staticClass:"mask",class:0===t.maskState?"none":1===t.maskState?"show":"",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.toggleMask.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"mask-content",on:{click:function(e){e.stopPropagation(),e.preventDefault(),arguments[0]=e=t.$handleEvent(e),t.stopPrevent.apply(void 0,arguments)}}},t._l(t.user_coupon_list,(function(e,a){return i("v-uni-view",{key:a,class:{"coupon-item":!0,"gray-wrap":!e.checked},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.couponCheck(a,e)}}},[i("v-uni-view",{staticClass:"con"},[i("v-uni-view",{staticClass:"left"},[i("v-uni-text",{staticClass:"title"},[t._v(t._s(e.coupon.name))]),i("v-uni-text",{staticClass:"time"},[t._v("有效期至"+t._s(t.formatTime(e.coupon.expire_time)))])],1),i("v-uni-view",{staticClass:"right"},[i("v-uni-text",{staticClass:"price"},[t._v(t._s(e.coupon.amount)+t._s(2==e.coupon.type?"折":"元"))]),i("v-uni-text")],1),i("v-uni-view",{staticClass:"circle l"}),i("v-uni-view",{staticClass:"circle r"})],1),i("v-uni-text",{staticClass:"tips"},[t._v(t._s(e.coupon.full_amount>0?"满"+e.coupon.full_amount+"元可用":"无使用限制")),e.coupon.is_superimposed?[t._v("(可叠加使用)")]:t._e()],2)],1)})),1)],1)],1)},s=[]},c1b1:function(t,e,i){"use strict";i.r(e);var a=i("7a25"),s=i.n(a);for(var o in a)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return a[t]}))}(o);e["default"]=s.a},ce2c:function(t,e,i){var a=i("24fb");e=a(!1),e.push([t.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 通用 */\r\n/* 文字尺寸 */\r\n/* 页面配置 */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */uni-page-body[data-v-447e117a]{background:#f8f8f8;padding-bottom:%?100?%}body.?%PAGE?%[data-v-447e117a]{background:#f8f8f8}.address-section[data-v-447e117a]{padding:%?30?% 0;background:#fff;position:relative}.address-section .addr-content[data-v-447e117a]{display:flex;align-items:center;padding:0 10px}.address-section .icon-shouhuodizhi[data-v-447e117a]{flex-shrink:0;display:flex;align-items:center;justify-content:center;width:%?90?%;color:#888;font-size:%?44?%}.address-section .cen[data-v-447e117a]{display:flex;flex-direction:column;flex:1;font-size:%?28?%;color:#303133}.address-section .name[data-v-447e117a]{font-size:%?34?%;margin-right:%?24?%}.address-section .address[data-v-447e117a]{margin-top:%?16?%;margin-right:%?20?%;color:#909399}.address-section .icon-you[data-v-447e117a]{font-size:%?32?%;color:#909399;margin-right:%?30?%}.address-section .a-bg[data-v-447e117a]{position:absolute;left:0;bottom:0;display:block;width:100%;height:%?5?%}.goods-section[data-v-447e117a]{margin-top:%?16?%;background:#fff;padding-bottom:1px}.goods-section .g-header[data-v-447e117a]{display:flex;align-items:center;height:%?84?%;padding:0 %?30?%;position:relative}.goods-section .name[data-v-447e117a]{font-size:%?30?%;color:#606266;margin-left:%?24?%}.goods-section .g-item[data-v-447e117a]{display:flex;margin:%?20?% %?30?%}.goods-section .g-item uni-image[data-v-447e117a]{flex-shrink:0;display:block;width:%?140?%;height:%?140?%;border-radius:%?4?%}.goods-section .g-item .right[data-v-447e117a]{flex:1;padding-left:%?24?%;overflow:hidden}.goods-section .g-item .title[data-v-447e117a]{font-size:%?30?%;color:#303133}.goods-section .g-item .spec[data-v-447e117a]{font-size:%?26?%;color:#909399}.goods-section .g-item .price-box[data-v-447e117a]{display:flex;align-items:center;font-size:%?32?%;color:#303133;padding-top:%?10?%}.goods-section .g-item .price-box .price[data-v-447e117a]{margin-bottom:%?4?%}.goods-section .g-item .price-box .number[data-v-447e117a]{font-size:%?26?%;color:#606266;margin-left:%?20?%}.goods-section .g-item .step-box[data-v-447e117a]{position:relative}.yt-list[data-v-447e117a]{margin-top:%?16?%;background:#fff}.yt-list-cell[data-v-447e117a]{display:flex;align-items:center;padding:%?10?% %?30?% %?10?% %?40?%;line-height:%?70?%;position:relative}.yt-list-cell.cell-hover[data-v-447e117a]{background:#fafafa}.yt-list-cell.b-b[data-v-447e117a]:after{left:%?30?%}.yt-list-cell .cell-icon[data-v-447e117a]{height:%?32?%;width:%?32?%;font-size:%?22?%;color:#fff;text-align:center;line-height:%?32?%;background:#f85e52;border-radius:%?4?%;margin-right:%?12?%}.yt-list-cell .cell-icon.hb[data-v-447e117a]{background:#ffaa0e}.yt-list-cell .cell-icon.lpk[data-v-447e117a]{background:#3ab54a}.yt-list-cell .cell-more[data-v-447e117a]{align-self:center;font-size:%?24?%;color:#909399;margin-left:%?8?%;margin-right:%?-10?%}.yt-list-cell .cell-tit[data-v-447e117a]{flex:1;font-size:%?26?%;color:#909399;margin-right:%?10?%}.yt-list-cell .cell-tip[data-v-447e117a]{font-size:%?26?%;color:#303133}.yt-list-cell .cell-tip.disabled[data-v-447e117a]{color:#909399}.yt-list-cell .cell-tip.active[data-v-447e117a]{color:#27c2f3}.yt-list-cell .cell-tip.red[data-v-447e117a]{color:#27c2f3}.yt-list-cell.desc-cell .cell-tit[data-v-447e117a]{max-width:%?90?%}.yt-list-cell .desc[data-v-447e117a]{flex:1;font-size:%?28?%;color:#303133}\r\n/* 支付列表 */.pay-list[data-v-447e117a]{padding-left:%?40?%;margin-top:%?16?%;background:#fff}.pay-list .pay-item[data-v-447e117a]{display:flex;align-items:center;padding-right:%?20?%;line-height:1;height:%?110?%;position:relative}.pay-list .icon-weixinzhifu[data-v-447e117a]{width:%?80?%;font-size:%?40?%;color:#6bcc03}.pay-list .icon-alipay[data-v-447e117a]{width:%?80?%;font-size:%?40?%;color:#06b4fd}.pay-list .icon-xuanzhong2[data-v-447e117a]{display:flex;align-items:center;justify-content:center;width:%?60?%;height:%?60?%;font-size:%?40?%;color:#27c2f3}.pay-list .tit[data-v-447e117a]{font-size:%?32?%;color:#303133;flex:1}.footer[data-v-447e117a]{position:fixed;left:0;bottom:0;z-index:995;display:flex;align-items:center;width:100%;height:%?90?%;justify-content:space-between;font-size:%?30?%;background-color:#fff;z-index:998;color:#606266;box-shadow:0 -1px 5px rgba(0,0,0,.1)}.footer .price-content[data-v-447e117a]{padding-left:%?30?%}.footer .price-tip[data-v-447e117a]{color:#27c2f3;margin-left:%?8?%}.footer .price[data-v-447e117a]{font-size:%?36?%;color:#27c2f3}.footer .submit[data-v-447e117a]{display:flex;align-items:center;justify-content:center;width:%?280?%;height:100%;color:#fff;font-size:%?32?%;background-color:#27c2f3}\r\n/* 优惠券面板 */.mask[data-v-447e117a]{display:flex;align-items:flex-end;position:fixed;left:0;top:var(--window-top);bottom:0;width:100%;background:transparent;z-index:9995;transition:.3s}.mask .mask-content[data-v-447e117a]{width:100%;min-height:30vh;max-height:70vh;background:#f3f3f3;-webkit-transform:translateY(100%);transform:translateY(100%);transition:.3s;overflow-y:scroll}.mask.none[data-v-447e117a]{display:none}.mask.show[data-v-447e117a]{background:rgba(0,0,0,.4)}.mask.show .mask-content[data-v-447e117a]{-webkit-transform:translateY(0);transform:translateY(0)}.gray-wrap[data-v-447e117a]{-webkit-filter:grayscale(1);\r\n  /* Webkit */filter:gray;\r\n  /* IE6-9 */filter:grayscale(1)\r\n  /* W3C */}\r\n/* 优惠券列表 */.coupon-item[data-v-447e117a]{-webkit-mask-size:100% 100%;mask-size:100% 100%;background:linear-gradient(90deg,#fcbd71,#f90);display:flex;flex-direction:column;margin:%?20?% %?24?%;border-radius:8px;color:#fff}.coupon-item .con[data-v-447e117a]{display:flex;align-items:center;position:relative;height:%?120?%;padding:0 %?30?%}.coupon-item .con[data-v-447e117a]:after{position:absolute;left:0;bottom:0;content:"";width:100%;height:0;border-bottom:1px dashed #f3f3f3;-webkit-transform:scaleY(50%);transform:scaleY(50%)}.coupon-item .left[data-v-447e117a]{display:flex;flex-direction:column;justify-content:center;flex:1;overflow:hidden;height:%?100?%}.coupon-item .title[data-v-447e117a]{font-size:%?32?%;margin-bottom:%?10?%}.coupon-item .time[data-v-447e117a]{font-size:%?24?%}.coupon-item .right[data-v-447e117a]{display:flex;flex-direction:column;justify-content:center;align-items:center;font-size:%?26?%;height:%?100?%}.coupon-item .price[data-v-447e117a]{font-size:%?44?%}.coupon-item .tips[data-v-447e117a]{font-size:%?24?%;line-height:%?60?%;padding-left:%?30?%}.coupon-item .circle[data-v-447e117a]{position:absolute;left:%?-6?%;bottom:%?-10?%;z-index:10;width:%?20?%;height:%?20?%;background:#f3f3f3;border-radius:100px}.coupon-item .circle.r[data-v-447e117a]{left:auto;right:%?-6?%}',""]),t.exports=e},dd3a:function(t,e,i){"use strict";i.r(e);var a=i("b3d7"),s=i("c1b1");for(var o in s)["default"].indexOf(o)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(o);i("1ede");var n=i("f0c5"),c=Object(n["a"])(s["default"],a["b"],a["c"],!1,null,"447e117a",null,!1,a["a"],void 0);e["default"]=c.exports},fec9:function(t,e,i){var a=i("ce2c");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var s=i("4f06").default;s("dee2344e",a,!0,{sourceMap:!1,shadowMode:!1})}}]);