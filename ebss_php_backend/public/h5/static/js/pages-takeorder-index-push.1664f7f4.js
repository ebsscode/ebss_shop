(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-takeorder-index-push"],{"2e4c":function(t,e,n){var a=n("c86c");e=a(!1),e.push([t.i,'@charset "UTF-8";\n/**\n * 这里是uni-app内置的常用样式变量\n *\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\n *\n */\n/**\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\n *\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\n */\n/* 通用 */\n/* 文字尺寸 */\n/* 页面配置 */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */.upload-content[data-v-74f00c9e]{display:flex;align-items:center;margin-bottom:10px;margin-right:10px;flex-wrap:wrap}.upload-item[data-v-74f00c9e]{position:relative;float:left;width:%?150?%;height:%?150?%;margin-right:8px;margin-bottom:8px}.upload-item .upload-img[data-v-74f00c9e]{width:100%;height:100%;border-radius:%?8?%}.upload-item .upload-del-btn[data-v-74f00c9e]{position:absolute;right:-8px;top:-11px;width:%?36?%;height:%?36?%;border:%?4?% solid #fff;border-radius:100px;color:#f32779}.upload-item .upload-progress[data-v-74f00c9e]{position:absolute;left:0;top:0;display:flex;align-items:center;justify-content:center;width:100%;height:100%;background-color:rgba(0,0,0,.4);color:#fff;font-size:%?24?%;border-radius:%?8?%}.upload-add-btn[data-v-74f00c9e]{position:relative;float:left;width:%?150?%;height:%?150?%;z-index:99;border-radius:%?8?%;background:#f9f9f9}.upload-add-btn[data-v-74f00c9e]:before, .upload-add-btn[data-v-74f00c9e]:after{content:" ";position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);width:%?4?%;height:%?60?%;background-color:#d6d6d6}.upload-add-btn[data-v-74f00c9e]:after{width:%?60?%;height:%?4?%}.upload-add-btn[data-v-74f00c9e]:active{background-color:#f7f7f7}',""]),t.exports=e},"30e2":function(t,e,n){"use strict";var a=n("840f"),i=n.n(a);i.a},"46cf":function(t,e,n){var a=n("8cb8");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var i=n("967d").default;i("30703967",a,!0,{sourceMap:!1,shadowMode:!1})},"4aa2":function(t,e,n){"use strict";var a=n("46cf"),i=n.n(a);i.a},"63e9":function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"c",(function(){return r})),n.d(e,"a",(function(){return a}));var a={uniForms:n("6f9b").default,uniFormsItem:n("4b9f").default,uniEasyinput:n("0ee5").default},i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticStyle:{padding:"20rpx 10px"}},[n("StatusBar"),n("TopBar",{attrs:{title:""}}),n("v-uni-view",{staticStyle:{height:"30px"}}),n("uni-forms",{ref:"form",attrs:{model:t.form,rules:t.rules}},[n("uni-forms-item",{attrs:{label:"上门地址",name:"address",required:!0,"label-width":"90px"}},[n("v-uni-view",{staticClass:"align-center justify-between",staticStyle:{width:"100%"}},[n("uni-easyinput",{attrs:{placeholder:"请输入"},model:{value:t.form.address,callback:function(e){t.$set(t.form,"address",e)},expression:"form.address"}}),n("v-uni-text",{staticClass:"QQ811565456 hewei-shouhuodizhi",staticStyle:{"font-size":"20px",padding:"6px 8px"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.chooseMap.apply(void 0,arguments)}}})],1)],1),n("uni-forms-item",{attrs:{label:"联系人",name:"title","label-width":"90px"}},[n("uni-easyinput",{attrs:{placeholder:"请输入"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),n("uni-forms-item",{attrs:{label:"联系电话",name:"title","label-width":"90px"}},[n("uni-easyinput",{attrs:{placeholder:"请输入"},model:{value:t.form.title,callback:function(e){t.$set(t.form,"title",e)},expression:"form.title"}})],1),n("uni-forms-item",{attrs:{label:"留言",name:"submitter_tel","label-width":"90px"}},[n("uni-easyinput",{attrs:{type:"textarea",placeholder:"请输入"},model:{value:t.form.submitter_tel,callback:function(e){t.$set(t.form,"submitter_tel",e)},expression:"form.submitter_tel"}})],1),n("uni-forms-item",{attrs:{label:"照片",name:"logo_img","label-width":"90px"}},[n("ImgUpload",{attrs:{max:1},model:{value:t.form.logo_img,callback:function(e){t.$set(t.form,"logo_img",e)},expression:"form.logo_img"}})],1),n("v-uni-view",{staticClass:"btn-primary",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.submit.apply(void 0,arguments)}}},[t._v("提交")])],1)],1)},r=[]},7112:function(t,e,n){"use strict";n.r(e);var a=n("a89c"),i=n.n(a);for(var r in a)["default"].indexOf(r)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(r);e["default"]=i.a},8346:function(t,e,n){"use strict";n.r(e);var a=n("e101"),i=n("7112");for(var r in i)["default"].indexOf(r)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(r);n("30e2");var o=n("828b"),s=Object(o["a"])(i["default"],a["b"],a["c"],!1,null,"74f00c9e",null,!1,a["a"],void 0);e["default"]=s.exports},"840f":function(t,e,n){var a=n("2e4c");a.__esModule&&(a=a.default),"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var i=n("967d").default;i("1425af52",a,!0,{sourceMap:!1,shadowMode:!1})},"8cb8":function(t,e,n){var a=n("c86c");e=a(!1),e.push([t.i,'@charset "UTF-8";\n/**\n * 这里是uni-app内置的常用样式变量\n *\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\n *\n */\n/**\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\n *\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\n */\n/* 通用 */\n/* 文字尺寸 */\n/* 页面配置 */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */.form-item[data-v-149156d0]{display:flex;align-items:center}',""]),t.exports=e},9972:function(t,e,n){"use strict";(function(t){n("6a54");var a=n("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=a(n("2634")),r=a(n("2fdc")),o=a(n("9b1b")),s=a(n("8346")),u=n("e2ef"),l={components:{ImgUpload:s.default},data:function(){return{type:"",rules:{name:{rules:[{required:!0,errorMessage:"名称不能为空"}]},address:{rules:[{required:!0,errorMessage:"地址不能为空"}]}},form:{services:[],address:""}}},onLoad:function(t){t.type&&(this.type=t.type,"join"==t.type&&(uni.setNavigationBarTitle({title:"服务点加盟"}),this.rules.title={rules:[{required:!0,errorMessage:"简介不能为空"}]},this.rules.open_time={rules:[{required:!0,errorMessage:"开放时间不能为空"}]},this.rules.log_img={rules:[{required:!0,errorMessage:"门头照片不能为空"}]},this.rules.device_img={rules:[{required:!0,errorMessage:"设置照片不能为空"}]},this.rules.owner_tel={rules:[{required:!0,errorMessage:"联系方式不能为空"}]}))},methods:{submit:function(e){var n=this;t.log("form",this.form),this.$refs.form.validate().then((function(e){t.log("表单数据信息：",e),n.post("crud/save",(0,o.default)({table:"mch"},n.form)).then((function(t){var e=t.code;1===e&&n.success("您的需求发布成功，系统将马上安排专员对接！")}))})).catch((function(e){t.log("表单错误信息：",e),n.error(e[0].errorMessage)}))},chooseMap:function(){var t=this;return(0,r.default)((0,i.default)().mark((function e(){var n;return(0,i.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,(0,u.chooseLocation)();case 2:n=e.sent,1==n.code&&(t.form=n);case 4:case"end":return e.stop()}}),e)})))()}}};e.default=l}).call(this,n("ba7c")["default"])},a89c:function(t,e,n){"use strict";(function(t){n("6a54");var a=n("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=a(n("2634")),r=a(n("2fdc"));n("64aa"),n("fd3c"),n("aa9c"),n("dd2b"),n("d4b5"),n("bf0f");var o={data:function(){return{imageList:[]}},props:{value:{type:[String]},chooseCount:{type:Number,value:5},max:{type:Number,value:100}},watch:{value:{handler:function(e,n){if(e){if(1==this.max&&(this.imageList=[{url:e}]),this.max>1)try{this.imageList=JSON.parse(e).map((function(t){return{url:t}}))}catch(a){this.imageList=[],t.warn("ImgUpload解析错出：",a)}}else this.imageList=[];this.emitValue()},immediate:!0}},computed:{rduLength:function(){return this.max-this.imageList.length}},methods:{chooseImage:function(){var t=this;uni.chooseImage({count:this.rduLength<this.chooseCount?this.rduLength:this.chooseCount,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(e){var n=e.tempFilePaths;t.uploadFiles(n)}})},uploadFiles:function(e){var n=this;return(0,r.default)((0,i.default)().mark((function a(){var r,o;return(0,i.default)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n.imageList.push({progress:0}),uni.showLoading({title:"请稍后..",mask:!0}),r=null,a.prev=3,a.next=6,n.uploadImage(e[0]);case 6:r=a.sent,t.log(11,r),a.next=14;break;case 10:return a.prev=10,a.t0=a["catch"](3),t.log(a.t0),a.abrupt("return");case 14:!1!==r?(e.splice(0,1),o=JSON.parse(JSON.stringify(n.imageList)),o[o.length-1].url=r,n.imageList=o,e.length>0&&n.rduLength>0?n.uploadFiles(e):uni.hideLoading(),n.emitValue()):(n.imageList.pop(),uni.hideLoading(),uni.showToast({title:"上传中出现问题，已终止上传",icon:"none",mask:!0,duration:2e3}));case 15:case"end":return a.stop()}}),a,null,[[3,10]])})))()},uploadImage:function(e){var n=this;return new Promise((function(a,i){n.uploadTask=uni.uploadFile({url:n.baseURL()+"/api/index/upload",filePath:e,name:"file",formData:{},success:function(e){var n=JSON.parse(e.data)||{};t.log("111",n),1==n.code&&n.savename?a(n.savename):i("接口返回错误")},fail:function(){i("网络链接错误")}}),n.uploadTask.onProgressUpdate((function(t){n.imageList[n.imageList.length-1].progress=t.progress}))}))},delImage:function(t){var e=this;uni.showModal({content:"确定要丢弃这张图片么？",success:function(n){n.confirm&&(e.imageList.splice(t,1),e.emitValue())}})},emitValue:function(){1==this.max&&(this.imageList.length?this.$emit("input",this.imageList[0].url):this.$emit("input","")),this.max>1&&(this.imageList.length?this.$emit("input",JSON.stringify(this.imageList.map((function(t){return t.url})))):this.$emit("input","[]"))},previewImage:function(t){var e=this,n=this.imageList.map((function(t){return e.staticURL()+"/"+t.url}));uni.previewImage({current:n[t],urls:n,indicator:"number"})}}};e.default=o}).call(this,n("ba7c")["default"])},b024:function(t,e,n){"use strict";n.r(e);var a=n("9972"),i=n.n(a);for(var r in a)["default"].indexOf(r)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(r);e["default"]=i.a},e101:function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){}));var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"upload-content"},[t._l(t.imageList,(function(e,a){return[n("v-uni-view",{key:a+"_0",staticClass:"upload-item"},[e.url?n("v-uni-image",{staticClass:"upload-img",attrs:{src:t.staticURL()+"/"+e.url,mode:"aspectFill"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.previewImage(a)}}}):n("v-uni-view",{staticClass:"upload-img",staticStyle:{"background-color":"#C0C4CC"}}),n("v-uni-text",{staticClass:"QQ811565456 hewei-cuowu upload-del-btn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.delImage(a)}}}),e.progress&&e.progress<100?n("v-uni-view",{staticClass:"upload-progress"},[t._v(t._s(e.progress)+"%")]):t._e()],1)]})),t.rduLength>0?n("v-uni-view",{staticClass:"upload-add-btn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.chooseImage.apply(void 0,arguments)}}}):t._e()],2)},i=[]},e1f8:function(t,e,n){"use strict";n.r(e);var a=n("63e9"),i=n("b024");for(var r in i)["default"].indexOf(r)<0&&function(t){n.d(e,t,(function(){return i[t]}))}(r);n("4aa2");var o=n("828b"),s=Object(o["a"])(i["default"],a["b"],a["c"],!1,null,"149156d0",null,!1,a["a"],void 0);e["default"]=s.exports},e2ef:function(t,e,n){"use strict";(function(t){n("6a54");var a=n("f5bd").default;Object.defineProperty(e,"__esModule",{value:!0}),e.openLocation=e.getLocation=e.getDistance=e.chooseLocation=void 0;var i=a(n("2634")),r=a(n("2fdc"));n("bf0f"),n("d4b5");var o=n("38df");e.getDistance=function(t,e,n,a){var i=t*Math.PI/180,r=n*Math.PI/180,o=i-r,s=e*Math.PI/180-a*Math.PI/180,u=2*Math.asin(Math.sqrt(Math.pow(Math.sin(o/2),2)+Math.cos(i)*Math.cos(r)*Math.pow(Math.sin(s/2),2)));return u*=6378.137,u=Math.round(1e4*u)/1e4,u.toFixed(2)};e.getLocation=function(){return new Promise((function(e,n){uni.getLocation({type:"gcj02",success:function(){var n=(0,r.default)((0,i.default)().mark((function n(a){var r,s;return(0,i.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r={},uni.setStorageSync("latitude",a.latitude),uni.setStorageSync("longitude",a.longitude),n.next=5,(0,o.http)("get","location/latlng_to_addr",{latitude:a.latitude,longitude:a.longitude});case 5:s=n.sent,s&&1==s.code?(uni.setStorageSync("location",s),r=s):t.error("getLocation-失败：",s),e(r);case 8:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}(),fail:function(e){t.error("获取位置失败:"+e.errMsg),n(e)},complete:function(e){var n=uni.getStorageSync("configs");n&&1==n.is_debug&&t.error(JSON.stringify(e))}})}))};e.chooseLocation=function(){return new Promise((function(e,n){uni.chooseLocation({type:"gcj02",success:function(){var n=(0,r.default)((0,i.default)().mark((function n(a){var r,s;return(0,i.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return r={},n.next=3,(0,o.http)("get","location/latlng_to_addr",{latitude:a.latitude,longitude:a.longitude});case 3:s=n.sent,s&&1==s.code?r=s:t.error("chooseLocation-失败：",s),e(r);case 6:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}(),fail:function(e){t.error("选择位置失败:"+e.errMsg,2e3),n(e)}})}))};e.openLocation=function(e,n){uni.openLocation({latitude:1*n,longitude:1*e,success:function(){t.log("success")}})}}).call(this,n("ba7c")["default"])}}]);