(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-video-index-play"],{"1cd6":function(t,e,i){"use strict";i.r(e);var o=i("e062"),n=i.n(o);for(var a in o)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return o[t]}))}(a);e["default"]=n.a},3290:function(t,e,i){"use strict";i.r(e);var o=i("a851"),n=i("3dfd");for(var a in n)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(a);i("c916");var r=i("f0c5"),s=Object(r["a"])(n["default"],o["b"],o["c"],!1,null,"772741e9",null,!1,o["a"],void 0);e["default"]=s.exports},"33de":function(t,e,i){"use strict";i("7a82");var o=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("99af"),i("d81d"),i("14d9"),i("c740");var n=o(i("2909")),a=o(i("c7eb")),r=o(i("1da1")),s=o(i("5a20")),c=uni.createInnerAudioContext();c.loop=!0;var d={components:{OperaCollection:s.default},data:function(){return{windowWidth:0,windowHeight:0,platform:"",model:"",deleteHeight:0,dataList:[],k:0,oldVideo:"",voice:"",timeout:"",current:0,boxStyle:{height:0,width:0},isShow:!1,showPlay:!1,rotates:0,rotateTime:"",xrotats:"",mpcleartime:"",isClick:!1,changeTimeout:"",mptime:0,mpstartTime:0,duration:500,opera_id:0,operaInfo:null,opera_collection_id:0,user_id:uni.getStorageSync("user_id")}},mounted:function(){var t=this;setTimeout((function(){t.$refs["OperaCollection"].open()}),2e3)},watch:{k:function(t,e){var i=this;return(0,r.default)((0,a.default)().mark((function o(){return(0,a.default)().wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(!(i.dataList[t].sort_num>i.operaInfo.free_num&&0==i.dataList[t].is_pay)){o.next=3;break}return console.log("未支付"),o.abrupt("return");case 3:console.log("k",t,e),i.isShow=!1,i.dataList[e].playIng=!1,i.dataList[e].isplay=!0,i.dataList[e].state="pause",console.log("预留第"+(e+1)+"个视频："+i.dataList[e]._id+e),uni.createVideoContext(i.dataList[e]._id+""+e,i).stop(),console.log("已经暂停 --\x3e 第"+(e+1)+"个视频～"),i.dataList[t].state="play",i.isShow=!0,i.xrotats=setTimeout((function(){i.showPlay=!0}),200),clearTimeout(i.changeTimeout),i.dataList[t].isplay=!1,setTimeout((function(){i.dataList[t].playIng=!0}),250),i.mptime<.2?i.changeTimeout=setTimeout((function(){uni.createVideoContext(i.dataList[i.k]._id+""+i.k,i).play()}),1400):uni.createVideoContext(i.dataList[i.k]._id+""+i.k,i).play();case 18:case"end":return o.stop()}}),o)})))()}},onLoad:function(t){var e=this;this.opera_id=t.opera_id,t.opera_collection_id&&(this.opera_collection_id=t.opera_collection_id),this.platform=uni.getSystemInfoSync().platform,this.model=uni.getSystemInfoSync().model;var i=this.model;"ios"!=this.platform||"iPhone6"===i&&"iPhone6s"===i&&"iPhone7"===i&&"iPhone8"===i||(this.deleteHeight=0),this.windowWidth=uni.getSystemInfoSync().windowWidth,this.windowHeight=uni.getSystemInfoSync().windowHeight,this.boxStyle.width=this.windowWidth+"px",this.boxStyle.height=this.windowHeight-this.deleteHeight,this.get("crud/detail",{table:"opera",table_id:this.opera_id}).then((function(t){var i=t.code,o=t.detail;1==i&&(e.operaInfo=o,e.getData())}))},onShow:function(){0!==this.dataList.length&&(this.dataList[this.k].state="play",uni.createVideoContext(this.dataList[this.k]._id+""+this.k,this).play())},onHide:function(){this.dataList[this.k].state="pause",uni.createVideoContext(this.dataList[this.k]._id+""+this.k,this).pause()},methods:{onShareAppMessage:function(t){var e=encodeURIComponent("/pages/opera/video/play?opera_id=".concat(this.opera_id)),i="/pages/index/index?share_id=".concat(this.user_id,"&redirect_url=").concat(e);return console.log("path",i),{title:"邀请您观看各种好剧！",path:i}},mpTouchend:function(){this.mptime=new Date/1e3-this.mpstartTime},mpTouchstart:function(){this.mpstartTime=new Date/1e3},clearTime:function(){for(var t=0;t<20;t++)clearTimeout(this.rotateTime),clearTimeout(this.xrotats)},play:function(){this.get("crud/save",{table:"operalog",user_id:this.user_id,opera_id:this.opera_id,opera_collection_id:this.opera_collection_id}).then((function(t){t.code}))},ended:function(){},timeupdate:function(t){},tapVideoHover:function(t,e){console.log("state--",t),this.dataList[this.k].state="play"==t||"continue"==t?"pause":"continue","continue"==this.dataList[this.k].state&&(this.isClick=!0,this.dataList[this.k].playIng=!0,uni.createVideoContext(this.dataList[this.k]._id+""+this.k,this).play(),this.dataList[this.k].isplay=!1),"pause"==this.dataList[this.k].state&&(uni.createVideoContext(this.dataList[this.k]._id+""+this.k,this).pause(),this.dataList[this.k].isplay=!0)},change:function(t){var e=t.detail.current;if(this.dataList[e].sort_num>this.operaInfo.free_num&&0==this.dataList[e].is_pay)return this.error("请付费观看"),void this.$refs["pay-confirm"].open();this.k=e},stopTouchMove:function(t){console.log("stopTouchMove",t)},animationfinish:function(t){this.k==this.dataList.length-1&&(console.log("全部播放完了"),this.error("当前播放为最后一集"))},getData:function(){var t=this;this.get("operacollection/index",{table:"opera_collection",opera_id:this.opera_id,limit:9999}).then((function(e){var i=e.code,o=e.paginate;if(1==i){var a;t.isShow=!1;var r=o.data,s=r.map((function(e){return e.isplay=!0,e.playIng=!1,e.src=t.baseURL+"/"+e.video_url,e.state="pause",e._id=e.opera_collection_id,e}));(a=t.dataList).push.apply(a,(0,n.default)(s));var c=0;if(t.opera_collection_id){var d=t.dataList.findIndex((function(e){return e.opera_collection_id==t.opera_collection_id}));d>=0&&(c=d)}console.log("now_k",c),setTimeout((function(){t.isShow=!0,t.dataList[c].sort_num>t.operaInfo.free_num&&0==t.dataList[c].is_pay?t.$refs["pay-confirm"].open():(t.dataList[c].isplay=!1,t.dataList[c].state="play",t.dataList[c].playIng=!0,setTimeout((function(){uni.createVideoContext(t.dataList[c]._id+""+c,t).play(),t.current=c}),500))}),200),t.opera_collection_id=t.dataList[c]._id}}))}}};e.default=d},3910:function(t,e,i){"use strict";var o=i("6fbc"),n=i.n(o);n.a},"3dfd":function(t,e,i){"use strict";i.r(e);var o=i("33de"),n=i.n(o);for(var a in o)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return o[t]}))}(a);e["default"]=n.a},"5a20":function(t,e,i){"use strict";i.r(e);var o=i("d526"),n=i("1cd6");for(var a in n)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return n[t]}))}(a);i("3910");var r=i("f0c5"),s=Object(r["a"])(n["default"],o["b"],o["c"],!1,null,"0843e2d1",null,!1,o["a"],void 0);e["default"]=s.exports},"6fbc":function(t,e,i){var o=i("eb45");o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);var n=i("4f06").default;n("3c8ad0e3",o,!0,{sourceMap:!1,shadowMode:!1})},"837a":function(t,e,i){t.exports=i.p+"static/img/logo.8e105a41.jpg"},a851:function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return a})),i.d(e,"a",(function(){return o}));var o={uniIcons:i("829c").default},n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-uni-view",[o("StatusBar"),o("v-uni-swiper",{style:"width: "+t.windowWidth+"px; height: "+t.windowHeight+"px; background-color: #000000;",attrs:{vertical:!0,current:t.current,"indicator-dots":!1},on:{animationfinish:function(e){arguments[0]=e=t.$handleEvent(e),t.animationfinish.apply(void 0,arguments)},change:function(e){arguments[0]=e=t.$handleEvent(e),t.change.apply(void 0,arguments)},touchstart:function(e){arguments[0]=e=t.$handleEvent(e),t.mpTouchstart.apply(void 0,arguments)},touchend:function(e){arguments[0]=e=t.$handleEvent(e),t.mpTouchend.apply(void 0,arguments)}}},t._l(t.dataList,(function(e,n){return o("v-uni-swiper-item",{key:n,attrs:{catchtouchmove:"stopTouchMove"}},[Math.abs(t.k-n)<=1?o("v-uni-view",[o("v-uni-view",[t.isShow?o("v-uni-video",{style:"width: "+t.windowWidth+"px; height: "+t.windowHeight+"px; background-color: #000000; z-index: -1;",attrs:{id:e._id+""+n,loop:!0,muted:e.isplay,controls:!1,"http-cache":!0,"page-gesture":!1,"show-fullscreen-btn":!1,"show-loading":!1,"show-center-play-btn":!1,"enable-progress-gesture":!1,src:e.src,poster:t.baseURL+"/"+t.operaInfo.logo_img},on:{play:function(e){arguments[0]=e=t.$handleEvent(e),t.play.apply(void 0,arguments)},ended:function(e){arguments[0]=e=t.$handleEvent(e),t.ended.apply(void 0,arguments)},timeupdate:function(e){arguments[0]=e=t.$handleEvent(e),t.timeupdate.apply(void 0,arguments)},click:function(i){arguments[0]=i=t.$handleEvent(i),t.tapVideoHover(e.state,i)}}}):t._e(),e.playIng?t._e():o("v-uni-image",{style:"width: "+t.windowWidth+"px; height: "+t.windowHeight+"px; position: absolute;",attrs:{src:t.baseURL+"/"+t.operaInfo.logo_img,mode:"aspectFit"}})],1),o("v-uni-view",{staticClass:"videoHover",style:"width: "+t.windowWidth+"px; height: "+t.windowHeight+"px;",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.tapVideoHover(e.state,i)}}},["pause"==e.state?o("v-uni-image",{staticClass:"playState",attrs:{src:i("837a")}}):t._e()],1),o("v-uni-view",{staticClass:"content"},[t.operaInfo?o("v-uni-view",{staticClass:"name flex align-center"},[t._v(t._s(t.operaInfo.name))]):t._e(),t.operaInfo?o("v-uni-view",{staticClass:"flex align-center",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.$refs["OperaCollection"].open()}}},[t._v("更新至"+t._s(t.operaInfo.opera_collection_count)+"级 ，当前播放"+t._s(t.dataList[t.k].sort_num)+"集"),o("uni-icons",{attrs:{type:"forward",size:"14",color:"#ffffff"}})],1):t._e()],1)],1):t._e()],1)})),1),o("OperaCollection",{ref:"OperaCollection",attrs:{opera_id:t.opera_id,opera_collection_id:t.opera_collection_id}})],1)},a=[]},bb53:function(t,e,i){var o=i("dd8a");o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);var n=i("4f06").default;n("f8fcf080",o,!0,{sourceMap:!1,shadowMode:!1})},c916:function(t,e,i){"use strict";var o=i("bb53"),n=i.n(o);n.a},d526:function(t,e,i){"use strict";i.d(e,"b",(function(){return n})),i.d(e,"c",(function(){return a})),i.d(e,"a",(function(){return o}));var o={uniPopup:i("bf16").default},n=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"OperaCollection-container"},[i("uni-popup",{ref:"popup",attrs:{"mask-background-color":"rgba(0,0,0,0.4)",type:"bottom"}},[i("v-uni-view",{staticStyle:{padding:"10px",background:"#ffffff","border-top":"10px"}},[i("v-uni-view",{staticClass:"flex-col",staticStyle:{"padding-top":"10px","padding-bottom":"10px","border-bottom":"1px solid #c8c7cc","margin-bottom":"10px"}},[i("v-uni-text",{staticClass:"uifont",staticStyle:{"font-weight":"700","font-size":"18px"}},[t._v(t._s(t.operaInfo.name)+" ,"+t._s(t.opera_collection_id))]),i("v-uni-text",{staticClass:"uifont",staticStyle:{"font-size":"12px",color:"$C0C4CC","margin-top":"5px"}},[t._v("更新至第"+t._s(t.operacollectionList.total)+"集")])],1),i("v-uni-view",{staticClass:"grid-container",staticStyle:{width:"100%"}},[i("v-uni-scroll-view",{staticStyle:{height:"35vh",width:"100%"},attrs:{"scroll-y":!0}},[i("v-uni-view",{staticClass:"justify-start",staticStyle:{"flex-wrap":"wrap",width:"100%"}},[t.operacollectionList&&t.operacollectionList.total?t._l(t.operacollectionList.data,(function(e,o){return i("v-uni-view",{key:o,staticStyle:{width:"30%",position:"relative",height:"170px","border-radius":"10px",margin:"0 1.5%","margin-bottom":"10px"}},[i("v-uni-image",{staticStyle:{position:"absolute",width:"100%",height:"100%","border-radius":"10px","z-index":"1"},attrs:{src:t.baseURL+"/"+t.operaInfo.logo_img,mode:""},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.goPlay(e)}}}),e.sort_num>t.operaInfo.free_num&&0==e.is_pay?i("v-uni-view",{staticClass:"justify-center align-center flex-col",staticStyle:{position:"absolute","background-color":"rgba(0, 0, 0, 0.3)",height:"100%",width:"100%","z-index":"2","border-radius":"10px"},on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.openPay(e)}}},[i("v-uni-text",{staticClass:"myicon icon-jiesuo",staticStyle:{"font-size":"35px",color:"#ffffff"}}),i("v-uni-text",{staticStyle:{"font-size":"14px",color:"#ffffff"}},[t._v(t._s(t.operaInfo.v_money)+"币")])],1):t._e(),i("v-uni-view",{staticStyle:{position:"absolute","background-color":"rgba(0, 0, 0, 0.3)",width:"100%",bottom:"0","text-align":"center","border-bottom-right-radius":"10px","border-bottom-left-radius":"10px","z-index":"3",color:"#ffffff"}},[t._v("第"+t._s(e.sort_num)+"集")])],1)})):t._e()],2)],1)],1)],1)],1)],1)},a=[]},dd8a:function(t,e,i){var o=i("24fb");e=o(!1),e.push([t.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 通用 */\r\n/* 文字尺寸 */\r\n/* 页面配置 */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */.container[data-v-772741e9]{background-color:#000}.item[data-v-772741e9]{\r\n  /* width : 750rpx; */background-color:#000;position:relative}.videoHover[data-v-772741e9]{position:absolute;top:0;left:0;flex:1;display:flex;background-color:rgba(0,0,0,.1);justify-content:center;align-items:center\r\n  /* border-style: dashed;\r\n\tborder-color: #DD524D;\r\n\tborder-width: 1px; */}.playState[data-v-772741e9]{width:%?160?%;height:%?160?%;opacity:.5}.userInfo[data-v-772741e9]{position:absolute;bottom:110px;right:10px;flex-direction:column}.content[data-v-772741e9]{width:%?720?%;z-index:99;position:absolute;bottom:30px;\r\n  /* justify-content: center; */padding:%?15?%;font-size:%?28?%;display:flex;align-items:center;justify-content:space-between;color:#fff}.userName[data-v-772741e9]{font-size:%?30?%;color:#fff;margin-top:%?80?%}.words[data-v-772741e9]{margin-top:%?10?%;font-size:%?30?%;color:#fff}.root[data-v-772741e9]{background-color:#000}',""]),t.exports=e},e062:function(t,e,i){"use strict";i("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("a9e3");var o={name:"OperaCollection",components:{},props:{opera_id:{type:Number,default:0},opera_collection_id:{type:Number,default:0}},data:function(){return{baseURL:this.baseURL,operaInfo:null,operacollectionList:null,userInfo:{}}},created:function(){var t=this;this.get("crud/detail",{table:"opera",table_id:this.opera_id}).then((function(e){var i=e.code,o=e.detail;1==i&&(t.operaInfo=o)})),this.get("operacollection/index",{limit:1e3,opera_id:this.opera_id}).then((function(e){var i=e.code,o=e.paginate;1==i&&(t.operacollectionList=o)})),this.get("user/user_info").then((function(e){var i=e.code,o=e.user_info;1==i&&(t.userInfo=o)}))},methods:{open:function(){this.$refs.popup.open()},close:function(){this.$refs.popup.close()},goPlay:function(t){(t.is_pay||t.sort_num<=this.operaInfo.free_num)&&this.redirect("/pages/opera/video/play?opera_id="+t.opera_id+"&opera_collection_id="+t.opera_collection_id)},openPay:function(t){var e=this;console.log(this.userInfo,this.operaInfo,t),1*this.userInfo.v_money<1*this.operaInfo.v_money?this.$refs["pay-confirm"].open():this.post("feelog/save",{vmoney:1*this.operaInfo.v_money,opera_id:t.opera_id,opera_collection_id:t.opera_collection_id}).then((function(i){var o=i.code;1==o&&(e.success("购买成功"),e.redirect("/pages/opera/video/play?opera_id="+t.opera_id+"&opera_collection_id="+t.opera_collection_id,1200))}))}}};e.default=o},eb45:function(t,e,i){var o=i("24fb");e=o(!1),e.push([t.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 通用 */\r\n/* 文字尺寸 */\r\n/* 页面配置 */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */.OperaCollection-container[data-v-0843e2d1]{z-index:9999;background:#fff;width:%?750?%;border-radius:%?32?% %?32?% 0 0;box-sizing:border-box;padding:%?24?%}',""]),t.exports=e}}]);